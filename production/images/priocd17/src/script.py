import json 
import pandas as pd 

# df = pd.read_csv('Priorisation_communes_lulu.csv')

# print(df['BDV'][df['Priorisation a l echelle de la commune']=="Pas Prioritaire"].tolist())

cantons = ['330632101', '330632102', '330632602', '330632603', '330632601', '330632604', '330632703', '330632702', '330632701', '330632704', '330632401', '330632402', '330632403', '330632404', '330632405', '330632406', '330632407', '330632501', '330632503', '330632502', '330632204', '330632202', '330632203', '330632201', '330632304', '330632303', '330632302', '330632301', '330633301', '330633302', '330633303', '330633304', '330633201', '330633203', '330633202', '330633205', '330633204', '330633504', '330633505', '330633502', '330633503', '330633501', '330633404', '330633403', '330633402', '330633401', '330633605', '330633604', '330633606', '330633601', '330633603', '330633602', '330633102', '330633103', '330633101', '330633104', '330634402', '330634403', '330634401', '330634502', '330634501', '330634601', '330634602', '330634802', '330634704', '330634801', '330634701', '330634703', '330634702', '330634103', '330634102', '330634101', '330634104', '330634201', '330634202', '330634203', '330634204', '330634803', '330634301', '330634302', '330634903', '330634902', '330634901', '330634904', '330634804', '330634805', '3306915', '3306914', '3306917', '3306916', '3306911', '3306910', '3306913', '3306912', '3306918', '330691', '330693', '330692', '330695', '330694', '330697', '330696', '330699', '330698', '330751', '330752', '330753', '330754', '330755', '330756', '330757', '330758', '330759', '3307512', '3307510', '3307511']

code_commune = '33069'
json_data=open('bdv_33069.json').read()

data = json.loads(json_data)

res = {"type":"FeatureCollection","properties":{},"features":[]}

for obj in data['features']:
	if (code_commune+str(obj['properties']['bdv_id'])) in cantons:
		res['features'].append(obj)

with open('bdv_bouscat.txt', 'w') as outfile:
    json.dump(res, outfile)